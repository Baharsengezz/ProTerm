<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ProTerm | Professional Terminology, Literature, Movies</title>
    <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>

<div id="playArea">
    <div id="welcomeText">ProTerm <span>The Game About Terminology</span></div>


    <div id="letters">
        <div onclick="letterPressed(this)" class="letter A" id="A">A</div>
        <div onclick="letterPressed(this)" class="letter B" id="B">B</div>
        <div onclick="letterPressed(this)" class="letter C" id="C">C</div>
        <div onclick="letterPressed(this)" class="letter D" id="D">D</div>
        <div onclick="letterPressed(this)" class="letter E" id="E">E</div>
        <div onclick="letterPressed(this)" class="letter F" id="F">F</div>
        <div onclick="letterPressed(this)" class="letter G" id="G">G</div>
        <div onclick="letterPressed(this)" class="letter H" id="H">H</div>
        <div onclick="letterPressed(this)" class="letter I" id="I">I</div>
        <div onclick="letterPressed(this)" class="letter J" id="J">J</div>
        <div onclick="letterPressed(this)" class="letter K" id="K">K</div>
        <div onclick="letterPressed(this)" class="letter L" id="L">L</div>
        <div onclick="letterPressed(this)" class="letter M" id="M">M</div>
        <div onclick="letterPressed(this)" class="letter N" id="N">N</div>
        <div onclick="letterPressed(this)" class="letter O" id="O">O</div>
        <div onclick="letterPressed(this)" class="letter P" id="P">P</div>
        <div onclick="letterPressed(this)" class="letter R" id="R">R</div>
        <div onclick="letterPressed(this)" class="letter S" id="S">S</div>
        <div onclick="letterPressed(this)" class="letter T" id="T">T</div>
        <div onclick="letterPressed(this)" class="letter U" id="U">U</div>
        <div onclick="letterPressed(this)" class="letter V" id="V">V</div>
        <div onclick="letterPressed(this)" class="letter Y" id="Y">Y</div>
        <div onclick="letterPressed(this)" class="letter Z" id="Z">Z</div>
        <div onclick="letterPressed(this)" class="letter W" id="W">W</div>
        <div onclick="letterPressed(this)" class="letter Q" id="Q">Q</div>
        <div onclick="letterPressed(this)" class="letter X" id="X">X</div>
    </div>


    <div id="theWord"></div>
</div>

<script src="assets/js/bundle.js"></script>
<script src="assets/js/lodash.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.11.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey           : "AIzaSyCvhUfzgu3Xb70kGxlMnBD6WXEGBv5jqCw",
    authDomain       : "theproterm.firebaseapp.com",
    databaseURL      : "https://theproterm.firebaseio.com",
    projectId        : "theproterm",
    storageBucket    : "theproterm.appspot.com",
    messagingSenderId: "1026041946667"
  };
  firebase.initializeApp(config);
</script>
<script>
  if (localStorage.getItem("isLogin") !== "1") {
    window.location.href = 'index.html';
  }
  var lettersElement = document.getElementById("letters");
  var wordElement = document.getElementById("theWord");
  var words = ["REACT", "HTML", "JQUERY", "JAVASCRIPT", "DESIGN", "DOCUMENT", "ANDROID"];

  var letters = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "R", "S", "T", "U", "V", "Y", "Z", "W", "Q", "X"];

  var wordIndex = Math.floor(Math.random() * words.length);

  var userPoint = 0;
  var wordPoint = words[wordIndex].length * 10;
  var hangedManPoint = wordPoint;

  console.log("Word Point:", wordPoint);

  function letterPressed(event) {
    var newPostKey;
    if (hangedManPoint <= 0) {
      newPostKey = firebase.database().ref('gameStatus/').child(localStorage.getItem("uid")).push().key;
      firebase.database().ref('gameStatus/' + localStorage.getItem("uid") + '/' + newPostKey).set({
        status: false
      });
    } else {
      if (_.includes(letters, event.id)) {
        if (_.includes(words[wordIndex], event.id)) {
          var theWord = document.getElementById('item-' + _.indexOf(words[wordIndex], event.id));
          theWord.innerHTML = event.id;
          userPoint = userPoint + 10;
          console.log("User Point:", userPoint);
          if (userPoint === wordPoint) {
            newPostKey = firebase.database().ref('gameStatus/').child(localStorage.getItem("uid")).push().key;
            firebase.database().ref('gameStatus/' + localStorage.getItem("uid") + '/' + newPostKey).set({
              status: true
            });
          }
        } else {
          hangedManPoint = hangedManPoint - 10;
          console.log("Hanged Man Point", hangedManPoint);
        }
        document.getElementById(event.id).style.background = "#cecece";
        document.getElementById(event.id).style.color = "#333";
      } else {

      }
    }


  }

  _.forEach(words[wordIndex], function (val, index) {
    wordElement.innerHTML += '<div id="item-' + index + '" data-key="' + index + '" class="letterByWord ' + val + '" ></div>';
  });


</script>
</body>
</html>